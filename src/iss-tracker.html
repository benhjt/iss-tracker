<html><head><link rel="import" href="../bower_components/polymer/polymer-element.html"><link rel="import" href="../bower_components/iron-ajax/iron-ajax.html"><link rel="import" href="../bower_components/paper-radio-group/paper-radio-group.html"><link rel="import" href="../bower_components/paper-radio-button/paper-radio-button.html"><link rel="import" href="../bower_components/paper-card/paper-card.html"><link rel="import" href="../bower_components/paper-checkbox/paper-checkbox.html"><link rel="import" href="../bower_components/google-map/google-map.html"><link rel="import" href="../bower_components/google-map/google-map-marker.html"></head><body><dom-module id="iss-tracker"><template><style>.data-section{background-color:white;bottom:25px;margin:0 auto;padding:25px;position:absolute;right:25px;z-index:1;}.data-section span{display:block;}google-map{height:100vh;}</style><iron-ajax auto="" url="https://api.wheretheiss.at/v1/satellites/25544?units=miles" handle-as="json" on-response="handlePositionResponse" id="ajaxRequest"></iron-ajax><google-map api-key="AIzaSyD3E1D9b-Z7ekrT3tbhl_dy8DCXuIuDDRc" id="map" zoom="3" latitude="25" longitude="0" map-type="hybrid"><google-map-marker latitude="[[latitude]]" longitude="[[longitude]]" title="ISS (ZARYA)"></google-map-marker></google-map><paper-card class="data-section"><paper-checkbox checked="{{centerMap}}">Center map</paper-checkbox><h2>[[satelliteName]]</h2><span>[[timeString]]</span> <span>Latitude: [[latitudeDisplay]]°</span> <span>Longitude: [[longitudeDisplay]]°</span> <span>Altitude: [[altitude]] [[distanceUnits]]</span> <span>Velocity: [[velocity]] [[speedUnits]]</span> <span>[[visibility]]</span><paper-radio-group selected="miles" id="unitsSelector"><paper-radio-button name="miles">miles</paper-radio-button><paper-radio-button name="kilometers">kilometers</paper-radio-button></paper-radio-group></paper-card></template><script>class IssTracker extends Polymer.Element{static get is(){return"iss-tracker"}constructor(){super();this.distanceUnits="miles";this.speedUnits="mph";this.horizonCircle=void 0;this.showHorizon=!0;this.centerMap=!0;this.termCircle=void 0}handlePositionResponse(e,data){this.updateValues(data.response);this._setISSVisibility(data.response.visibility);if(this.showHorizon){this.drawHorizon(data.response.footprint)}else{this.hideHorizon()}if(this.centerMap){const map=this.$.map;map.latitude=this.latitude;map.longitude=this.longitude}this.drawSunriseSunset(data.response.solar_lat,data.response.solar_lon);setTimeout(this.getISSPosition.bind(this),2e3)}updateValues(response){this.latitude=response.latitude;this.longitude=response.longitude;this.latitudeDisplay=this._formatNumber(response.latitude);this.longitudeDisplay=this._formatNumber(response.longitude);this.altitude=this._formatNumber(response.altitude);this.velocity=this._formatNumber(response.velocity)}_formatNumber(number){let formatted=Math.round(100*number)/100;formatted=new Intl.NumberFormat().format(number);return formatted}_setISSVisibility(visibility){switch(visibility){case"daylight":this.visibility="The ISS is in daylight";break;case"eclipsed":this.visibility="The ISS is in the Earth's shadow";break;}}drawHorizon(footprint){const horizonCenter=new google.maps.LatLng(this.latitude,this.longitude);let horizonRadius=footprint/2;if("miles"===this.distanceUnits){horizonRadius/=62137e-8}else{horizonRadius*=1e3}if("object"!==typeof this.horizonCircle){this.horizonCircle=new google.maps.Circle({strokeColor:"#FFFFFF",strokeOpacity:.8,strokeWeight:2,fillColor:"#FFFFFF",fillOpacity:.3,map:this.$.map.map,center:horizonCenter,radius:horizonRadius})}else{this.horizonCircle.setMap(this.$.map.map);this.horizonCircle.setCenter(horizonCenter);this.horizonCircle.setRadius(horizonRadius)}}hideHorizon(){if("object"===typeof this.horizonCircle){this.horizonCircle.setMap(null)}}drawSunriseSunset(solarLat,solarLong){const darkLat=-1*solarLat,darkLong=solarLong-180;if("object"!==typeof this.termCircle){this.termCircle=new google.maps.Circle({strokeColor:"black",strokeOpacity:.1,strokeWeight:5,fillColor:"black",fillOpacity:.4,map:this.$.map.map,center:new google.maps.LatLng(darkLat,darkLong),radius:10018790})}else{this.termCircle.setCenter(new google.maps.LatLng(darkLat,darkLong))}}getISSPosition(){const radioButtons=this.$.unitsSelector,ajaxRequest=this.$.ajaxRequest;this.distanceUnits=radioButtons.selected;if("miles"===this.distanceUnits){this.speedUnits="mph";ajaxRequest.url=ajaxRequest.url.replace("kilometers","miles")}else{this.speedUnits="kph";ajaxRequest.url=ajaxRequest.url.replace("miles","kilometers")}ajaxRequest.generateRequest()}showTime(){const now=new Date,time=now.toUTCString();this.timeString=time;setTimeout(this.showTime,500)}}window.customElements.define(IssTracker.is,IssTracker);</script></dom-module></body></html>